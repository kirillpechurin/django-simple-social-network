# Django Simple Social Network

[![ru](https://img.shields.io/badge/lang-ru-green.svg)](README.ru.md)
[![en](https://img.shields.io/badge/lang-en-red.svg)](README.md)
___

1. [Цель проекта](#цель-проекта)
2. [Реализация](#реализация)
    + [Техническая часть](#техническая-часть)
    + [Бизнес-задачи](#бизнес-задачи)
3. [Структура проекта](#структура-проекта)
4. [Описание переменных окружения](#описание-переменных-окружения)
5. [Запуск](#запуск)
    + [Зависимости](#зависимости)
    + [Запуск локального сервера разработки](#запуск-локального-сервера-разработки)
    + [Запуск в Docker](#запуск-в-docker)
6. [Лицензия](#лицензия)

___

## Цель проекта

Просто серверная часть социальной сети, которая может
служить основой для построения более сложных
систем социальных сетей.

## Реализация

___

### Техническая часть

* Приложение реализовано с использованием [Django Rest Framework](https://www.django-rest-framework.org/).
* Для хранения данных используется PostgreSQL.
* Для авторизации используется JWT.
* Отправка электронных писем по SMTP.
* Приложение упаковано в контейнеры с помощью Docker.
* Процесс CI настроен для веб-приложения, а именно для сборки, тестирования и оценки тестового покрытия.

### Бизнес-задачи

* Регистрация по логину с подтверждением адреса электронной почты.
* Возможность писать посты каждому зарегистрированному пользователю.
* Пользователь может поставить лайк на пост. Автор поста получит системное уведомление.
* Пользователь может комментировать посты. Автор публикации получит системное уведомление.
* Пользователь может подписаться на определенного автора. Его публикации будут первыми в результатах поиска.
* Уведомления о новых подписчиках и новых публикациях от автора.

## Структура проекта

___

- `db` - Конфигурация базы данных для Docker.
- `nginx` - Конфигурация NGINX для Docker.
- `src` - Веб-приложение.
    - `blog` - Все, что связано с публикациями, лайками и подписчиками.
    - `common` - Общая надслойка поверх фреймворка django rest framework для удобства работы.
    - `notifications` - Модуль уведомлений для обработки и отображения уведомлений.
    - `test_coverage` - Данные о конфигурации и тестовом покрытии.
    - `users` - Модуль пользователей, работа с персональными данными, авторизация и регистрация.
    - `.coveragerc` - Общий конфигурационный файл для тестового покрытия.
    - `.env.example` - Пример переменных окружения.
    - `.env.tests.template` - Шаблон для генерации переменных окружения при тестировании.
    - `entrypoint.sh` - Скрипт для запуска веб-приложения в Docker.
    - `requirements.tests.txt` - Дополнительные зависимости для тестирования веб-приложения.
    - `requirements.txt` - Основные зависимости веб-приложения.
    - `test.sh` - Тестовый сценарий запуска.

## Описание переменных окружения

___

* `SECRET_KEY` - Секретный ключ приложения Django.
* `DEBUG` - Режим отладки (0 или 1).
* `DB_NAME` - Наименование базы данных.
* `DB_USER` - Пользователь сервера базы данных.
* `DB_PASSWORD` - Пароль для пользователя сервера базы данных.
* `DB_HOST` - Хост, на котором запущен сервер базы данных.
* `DB_PORT` - Порт, на котором запущен сервер базы данных.
* `JWT_ALGORITHM` - Алгоритм из библиотеки PyJWT, который будет использоваться
  для выполнения операций подписи/верификации токенов.
* `JWT_SIGNING_KEY` - Ключ подписи, который используется для подписи содержимого сгенерированных токенов.
* `PASSWORD_RESET_TIMEOUT` - Тайм-аут для сброса пароля.
* `CONFIRM_EMAIL_TIMEOUT` - Время ожидания подтверждения по электронной почте.
* `PUBLIC_HOST` - Общедоступный хост (клиентский хост).
* `EMAIL_HOST` - Хост, на котором запущен SMTP-сервер.
* `EMAIL_PORT` - Порт, на котором запущен SMTP-сервер.
* `EMAIL_HOST_USER` - Пользователь SMTP-сервера.
* `EMAIL_HOST_PASSWORD` - Пароль для пользователя SMTP-сервера.
* `EMAIL_USE_TLS` - Следует ли использовать TLS (защищенное) соединение при общении с SMTP-сервером.
* `EMAIL_USE_SSL` - Следует ли использовать неявное TLS (защищенное) соединение при общении с SMTP-сервером.
* `DEFAULT_FROM_EMAIL` - Адрес электронной почты по умолчанию.

## Запуск

___

### Зависимости

* Установленная версия Python `3.10` или выше.
* Установленные пакеты:
    * `docker`
    * `docker-compose`

### Запуск локального сервера разработки

1. Создайте базу данных PostgreSQL для использования в веб-приложении.
2. Создайте `src/.env` файл и укажите в нем переменные окружения по примеру `src/.env.example`.
3. Запустите `python3 --version` и убедитесь, что у вас есть версия python `3.10` или выше.
4. `python3 -m venv venv` - Создание виртуальной окружения python в папке venv.
5. `source venv/bin/activate` - Активируйте виртуальное окружение.
6. `pip3 install -r requirements.txt && pip3 install -r requirements.tests.txt` - Установка зависимостей.
7. Вы уже готовы начать! Выполните следующую команду:

  ```shell
  python manage.py runserver 0.0.0.0:8000
  ```

Ваш локальный сервер разработки будет доступен на [http://0.0.0.0:8000](http://0.0.0.0:8000)

### Запуск в Docker

1. Создайте `src/.env` файл и укажите в нем переменные окружения по примеру `src/.env.example`
2. Создайте `db/.env` файл и укажите в нем переменные окружения по примеру `db/.env.example`
3. Вы уже готовы начать! Выполните следующую команду:
    ```shell
    docker-compose up -d --build
    ```

## Лицензия

___
См. [LICENSE](LICENSE)
